services:
  app:
    image: ${IMAGE_REF:-ghcr.io/REPLACE_ME/e2br3-web-server:latest}
    container_name: e2br3-web-server
    restart: unless-stopped
    ports:
      - "${APP_PORT:-8080}:8080"
    environment:
      SERVICE_BIND_ADDR: "0.0.0.0:8080"
      SERVICE_WEB_FOLDER: "/app/web-folder/"
      SERVICE_DB_URL: "${SERVICE_DB_URL}"
      SERVICE_PWD_KEY: "${SERVICE_PWD_KEY}"
      SERVICE_TOKEN_KEY: "${SERVICE_TOKEN_KEY}"
      SERVICE_TOKEN_DURATION_SEC: "${SERVICE_TOKEN_DURATION_SEC:-1800}"
      E2BR3_VALIDATOR_TOKEN: "${E2BR3_VALIDATOR_TOKEN}"
      E2BR3_XSD_PATH: "${E2BR3_XSD_PATH:-/app/schemas/multicacheschemas/MCCI_IN200100UV01.xsd}"
      E2BR3_SKIP_XML_VALIDATE: "${E2BR3_SKIP_XML_VALIDATE:-0}"
      E2BR3_EXPORT_VALIDATE: "${E2BR3_EXPORT_VALIDATE:-1}"
      E2BR3_DEFAULT_MESSAGE_SENDER: "${E2BR3_DEFAULT_MESSAGE_SENDER:-DSJP}"
      E2BR3_DEFAULT_MESSAGE_RECEIVER_FDA: "${E2BR3_DEFAULT_MESSAGE_RECEIVER_FDA:-CDER}"
      E2BR3_DEFAULT_MESSAGE_RECEIVER_ICH: "${E2BR3_DEFAULT_MESSAGE_RECEIVER_ICH:-ICHTEST}"
      E2BR3_DEFAULT_MESSAGE_RECEIVER_MFDS: "${E2BR3_DEFAULT_MESSAGE_RECEIVER_MFDS:-MFDS}"
      DEMO_USER_EMAIL: "${DEMO_USER_EMAIL:-demo.user@example.com}"
      DEMO_USER_PWD: "${DEMO_USER_PWD}"
      RUST_LOG: "${RUST_LOG:-web_server=info,lib_core=info,lib_web=info}"
      SKIP_DEV_INIT: "1"
    volumes:
      # If this is wrong/missing, you'll see:
      # "XSD parse error: Failed to locate the main schema resource at '/app/schemas/...'"
      - ${E2BR3_SCHEMAS_DIR:-./schemas}:/app/schemas:ro
